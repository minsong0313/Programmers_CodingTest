SELECT BK.CATEGORY, SUM(BS.SALES) AS TOTAL_SALES
FROM BOOK BK JOIN BOOK_SALES BS ON BK.BOOK_ID = BS.BOOK_ID
WHERE DATE_FORMAT(BS.SALES_DATE,'%Y-%m') = '2022-01'
GROUP BY BK.CATEGORY
ORDER BY BK.CATEGORY

-- Mysql
-- HAVING절에는 GROUP BY에 대한 조건을 줄 때 사용
-- 날짜는 전체 쿼리의 추출조건이므로 WHERE절에 써줘야함
-- ORACLE은 DATE_FORMAT함수 사용 못함 -> TO_CHAR함수 사용해서 날짜 추출


